\doxysection{dbscan.\+h}
\hypertarget{dbscan_8h_source}{}\label{dbscan_8h_source}\index{/Users/spirosmag/Documents/AlgoPlus/src/machine\_learning/clustering/DBSCAN/dbscan.h@{/Users/spirosmag/Documents/AlgoPlus/src/machine\_learning/clustering/DBSCAN/dbscan.h}}

\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{preprocessor}{\#ifndef\ DBSCAN\_H\ }}
\DoxyCodeLine{00002\ \textcolor{preprocessor}{\#define\ DBSCAN\_H\ }}
\DoxyCodeLine{00003\ }
\DoxyCodeLine{00004\ \textcolor{preprocessor}{\#ifdef\ \_\_cplusplus}}
\DoxyCodeLine{00005\ \textcolor{preprocessor}{\#include\ <iostream>}}
\DoxyCodeLine{00006\ \textcolor{preprocessor}{\#include\ <vector>}}
\DoxyCodeLine{00007\ \textcolor{preprocessor}{\#include\ <map>}}
\DoxyCodeLine{00008\ \textcolor{preprocessor}{\#include\ <math.h>}}
\DoxyCodeLine{00009\ \textcolor{preprocessor}{\#include\ <utility>}}
\DoxyCodeLine{00010\ \textcolor{preprocessor}{\#include\ <cstdint>}}
\DoxyCodeLine{00011\ \textcolor{preprocessor}{\#include\ <stdexcept>}}
\DoxyCodeLine{00012\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00013\ }
\DoxyCodeLine{00017\ \textcolor{keyword}{class\ }\mbox{\hyperlink{class_d_b_s_c_a_n}{DBSCAN}}\{}
\DoxyCodeLine{00018\ \textcolor{keyword}{private}:}
\DoxyCodeLine{00019\ \ \ std::vector<std::pair<double,\ double>>\ setOfPoints;}
\DoxyCodeLine{00020\ \ \ \textcolor{keywordtype}{double}\ Eps;}
\DoxyCodeLine{00021\ \ \ int64\_t\ MinPts;}
\DoxyCodeLine{00022\ \ \ int64\_t\ cluster\_id\{0\};}
\DoxyCodeLine{00023\ \ \ std::map<std::pair<double,\ double>,\ int64\_t>\ points;}
\DoxyCodeLine{00024\ }
\DoxyCodeLine{00025\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00026\ \ \ }
\DoxyCodeLine{00033\ \ \ \textcolor{keyword}{explicit}\ \mbox{\hyperlink{class_d_b_s_c_a_n_a052547e3cb21c270495f5fcf98e70b0a}{DBSCAN}}(std::vector<std::pair<double,\ double>>\ setOfPoints,\ \textcolor{keywordtype}{double}\ Eps,\ int64\_t\ MinPts)\ noexcept\ :\ setOfPoints(setOfPoints),\ Eps(Eps),\ MinPts(MinPts)\ \{}
\DoxyCodeLine{00034\ \ \ \ \ \textcolor{comment}{//\ cluster\_id\ is\ by\ default\ noise}}
\DoxyCodeLine{00035\ \ \ \ \ }
\DoxyCodeLine{00036\ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t}\ i\ =\ 0;\ i<setOfPoints.size();\ ++i)\{}
\DoxyCodeLine{00037\ \ \ \ \ \ \ \textcolor{keywordflow}{if}(points.find(setOfPoints[i])\ ==\ points.end())\{}
\DoxyCodeLine{00038\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{class_d_b_s_c_a_n_a0952151dd5397eb95092ba7518cb34a5}{ExpandCluster}}(setOfPoints,\ setOfPoints[i],\ cluster\_id,\ Eps,\ MinPts))\{}
\DoxyCodeLine{00039\ \ \ \ \ \ \ \ \ \ \ cluster\_id\ =\ \mbox{\hyperlink{class_d_b_s_c_a_n_a905021a89af288a06f9fcb7dbe935c75}{nextId}}(cluster\_id);}
\DoxyCodeLine{00040\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00041\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00042\ \ \ \ \ \}}
\DoxyCodeLine{00043\ \ \ \}}
\DoxyCodeLine{00044\ \ \ }
\DoxyCodeLine{00049\ \ \ int64\_t\ \mbox{\hyperlink{class_d_b_s_c_a_n_a905021a89af288a06f9fcb7dbe935c75}{nextId}}(int64\_t\ cluster\_id);}
\DoxyCodeLine{00050\ }
\DoxyCodeLine{00060\ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{class_d_b_s_c_a_n_a0952151dd5397eb95092ba7518cb34a5}{ExpandCluster}}(std::vector<std::pair<double,\ double>\ >\ setOfPoints,\ std::pair<double,\ double>\ point,\ int64\_t\ cluster\_id,\ \textcolor{keywordtype}{double}\ Eps,\ int64\_t\ MinPts);}
\DoxyCodeLine{00061\ \ \ }
\DoxyCodeLine{00069\ \ \ std::vector<std::pair<double,\ double>\ >\ \mbox{\hyperlink{class_d_b_s_c_a_n_aa9de3fa41342a0d23dd73bd15bca83e8}{get\_query}}(std::vector<std::pair<double,\ double>\ >\ setOfPoints,\ std::pair<double,\ double>\ point,\ \textcolor{keywordtype}{double}\ Eps);}
\DoxyCodeLine{00070\ \ \ }
\DoxyCodeLine{00077\ \ \ \textcolor{keywordtype}{double}\ \mbox{\hyperlink{class_d_b_s_c_a_n_a22318475f5a9ecb9b7911e4392eee422}{dist}}(std::pair<double,\ double>\ a,\ std::pair<double,\ double>\ b);}
\DoxyCodeLine{00078\ \ \ }
\DoxyCodeLine{00084\ \ \ std::map<std::pair<double,\ double>,\ int64\_t>\ \mbox{\hyperlink{class_d_b_s_c_a_n_aad8e927fe18f379b2c0cf65e9008ab42}{get\_clusters}}();}
\DoxyCodeLine{00085\ \ \ }
\DoxyCodeLine{00090\ \ \ std::vector<std::pair<double,\ double>\ >\ \mbox{\hyperlink{class_d_b_s_c_a_n_ac9cfb1bc65f74713a0e3e0ec5a42a0a4}{get\_noise}}();}
\DoxyCodeLine{00091\ \};}
\DoxyCodeLine{00092\ }
\DoxyCodeLine{00093\ int64\_t\ \mbox{\hyperlink{class_d_b_s_c_a_n_a905021a89af288a06f9fcb7dbe935c75}{DBSCAN::nextId}}(int64\_t\ cluster\_id)\{}
\DoxyCodeLine{00094\ \ \ \textcolor{keywordflow}{try}\{}
\DoxyCodeLine{00095\ \ \ \ \ \textcolor{keywordflow}{if}(cluster\_id\ <\ -\/1)\{}
\DoxyCodeLine{00096\ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ std::logic\_error(\textcolor{stringliteral}{"{}cluster\_id\ can't\ be\ less\ than\ -\/1"{}});}
\DoxyCodeLine{00097\ \ \ \ \ \}}
\DoxyCodeLine{00098\ \ \ \}}
\DoxyCodeLine{00099\ \ \ \textcolor{keywordflow}{catch}(std::logic\_error\ \&e)\{}
\DoxyCodeLine{00100\ \ \ \ \ std::cerr\ <<\ e.what()\ <<\ \textcolor{charliteral}{'\(\backslash\)n'};}
\DoxyCodeLine{00101\ \ \ \ \ \textcolor{keywordflow}{return}\ -\/2;}
\DoxyCodeLine{00102\ \ \ \}}
\DoxyCodeLine{00103\ \ \ cluster\_id++;}
\DoxyCodeLine{00104\ \ \ \textcolor{keywordflow}{return}\ cluster\_id;}
\DoxyCodeLine{00105\ \}}
\DoxyCodeLine{00106\ }
\DoxyCodeLine{00107\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{class_d_b_s_c_a_n_a0952151dd5397eb95092ba7518cb34a5}{DBSCAN::ExpandCluster}}(std::vector<std::pair<double,\ double>\ >\ setOfPoints,\ std::pair<double,\ double>\ point,\ int64\_t\ cluster\_id,\ \textcolor{keywordtype}{double}\ Eps,\ int64\_t\ MinPts)\{}
\DoxyCodeLine{00108\ \ \ std::vector<std::pair<double,\ double>\ >\ seeds\ =\ \mbox{\hyperlink{class_d_b_s_c_a_n_aa9de3fa41342a0d23dd73bd15bca83e8}{get\_query}}(setOfPoints,\ point,\ Eps);}
\DoxyCodeLine{00109\ \ \ \textcolor{keywordflow}{if}(seeds.size()\ <\ MinPts)\{}
\DoxyCodeLine{00110\ \ \ \ \ \textcolor{comment}{//\ no\ core\ point\ }}
\DoxyCodeLine{00111\ \ \ \ \ points[point]\ =\ -\/1;}
\DoxyCodeLine{00112\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00113\ \ \ \}}
\DoxyCodeLine{00114\ \ \ \textcolor{keywordflow}{else}\{}
\DoxyCodeLine{00115\ \ \ \ \ \textcolor{comment}{//\ we\ have\ a\ core\ point}}
\DoxyCodeLine{00116\ \ \ \ \ \textcolor{comment}{//\ all\ the\ points\ in\ seeds\ are\ density-\/reachable\ from\ point}}
\DoxyCodeLine{00117\ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keyword}{auto}\ \&\ x\ :\ seeds)\{}
\DoxyCodeLine{00118\ \ \ \ \ \ \ points[x]\ =\ cluster\_id;}
\DoxyCodeLine{00119\ \ \ \ \ \}}
\DoxyCodeLine{00120\ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keyword}{auto}\ it\ =\ seeds.begin();\ it\ !=\ seeds.end();\ it++)\{}
\DoxyCodeLine{00121\ \ \ \ \ \ \ \textcolor{keywordflow}{if}((*it).first\ ==\ point.first\ \&\&\ (*it).second\ ==\ point.second)\{}
\DoxyCodeLine{00122\ \ \ \ \ \ \ \ \ seeds.erase(it);}
\DoxyCodeLine{00123\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00124\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00125\ \ \ \ \ \}}
\DoxyCodeLine{00126\ }
\DoxyCodeLine{00127\ \ \ \ \ \textcolor{keywordflow}{while}(!seeds.empty())\{}
\DoxyCodeLine{00128\ \ \ \ \ \ \ \textcolor{keyword}{auto}\ current\ =\ seeds[0];}
\DoxyCodeLine{00129\ \ \ \ \ \ \ std::vector<std::pair<double,\ double>\ >\ result\ =\ \mbox{\hyperlink{class_d_b_s_c_a_n_aa9de3fa41342a0d23dd73bd15bca83e8}{get\_query}}(setOfPoints,\ current,\ Eps);}
\DoxyCodeLine{00130\ }
\DoxyCodeLine{00131\ \ \ \ \ \ \ \textcolor{keywordflow}{if}(result.size()\ >=\ MinPts)\{}
\DoxyCodeLine{00132\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t}\ i\ =\ 0;\ i<result.size();\ i++)\{}
\DoxyCodeLine{00133\ \ \ \ \ \ \ \ \ \ \ std::pair<double,\ double>\ result\_p\ =\ result[i];}
\DoxyCodeLine{00134\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(points.find(result\_p)\ ==\ points.end()\ ||\ points[result\_p]\ ==\ -\/1)\{}
\DoxyCodeLine{00135\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(points.find(result\_p)\ ==\ points.end())\{}
\DoxyCodeLine{00136\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ seeds.push\_back(result\_p);}
\DoxyCodeLine{00137\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00138\ \ \ \ \ \ \ \ \ \ \ \ \ points[result\_p]\ =\ cluster\_id;}
\DoxyCodeLine{00139\ \ \ \ \ \ \ \ \ \ \ \}\ \textcolor{comment}{//\ unclassified\ or\ noise}}
\DoxyCodeLine{00140\ \ \ \ \ \ \ \ \ \}\ \ \ \ \ \ }
\DoxyCodeLine{00141\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00142\ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keyword}{auto}\ it\ =\ seeds.begin();\ it\ !=\ seeds.end();\ it++)\{}
\DoxyCodeLine{00143\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}((*it).first\ ==\ current.first\ \&\&\ (*it).second\ ==\ current.second)\{}
\DoxyCodeLine{00144\ \ \ \ \ \ \ \ \ \ \ seeds.erase(it);}
\DoxyCodeLine{00145\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00146\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00147\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00148\ \ \ \ \ \}}
\DoxyCodeLine{00149\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00150\ \ \ \}}
\DoxyCodeLine{00151\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00152\ \}}
\DoxyCodeLine{00153\ }
\DoxyCodeLine{00154\ std::vector<std::pair<double,\ double>\ >\ \mbox{\hyperlink{class_d_b_s_c_a_n_aa9de3fa41342a0d23dd73bd15bca83e8}{DBSCAN::get\_query}}(std::vector<std::pair<double,\ double>\ >\ setOfPoints,\ std::pair<double,\ double>\ point,\ \textcolor{keywordtype}{double}\ Eps)\{}
\DoxyCodeLine{00155\ \ \ std::vector<std::pair<double,\ double>\ >\ ans;}
\DoxyCodeLine{00156\ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t}\ i\ =\ 0;\ i<setOfPoints.size();\ i++)\{}
\DoxyCodeLine{00157\ \ \ \ \ std::pair<double,\ double>\ curr\ =\ setOfPoints[i];}
\DoxyCodeLine{00158\ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{class_d_b_s_c_a_n_a22318475f5a9ecb9b7911e4392eee422}{dist}}(point,\ curr)\ <=\ Eps)\{}
\DoxyCodeLine{00159\ \ \ \ \ \ \ ans.push\_back(curr);}
\DoxyCodeLine{00160\ \ \ \ \ \}}
\DoxyCodeLine{00161\ \ \ \}}
\DoxyCodeLine{00162\ \ \ \textcolor{keywordflow}{return}\ ans;}
\DoxyCodeLine{00163\ \}}
\DoxyCodeLine{00164\ }
\DoxyCodeLine{00165\ \textcolor{keywordtype}{double}\ \mbox{\hyperlink{class_d_b_s_c_a_n_a22318475f5a9ecb9b7911e4392eee422}{DBSCAN::dist}}(std::pair<double,\ double>\ a,\ std::pair<double,\ double>\ b)\{}
\DoxyCodeLine{00166\ \ \ \textcolor{keywordflow}{return}\ sqrt(\ pow(b.second\ -\/\ a.second,\ 2)\ +\ pow(b.first\ -\/\ a.first,\ 2)\ );}
\DoxyCodeLine{00167\ \}}
\DoxyCodeLine{00168\ }
\DoxyCodeLine{00169\ std::map<\ std::pair<double,\ double>,\ int64\_t>\ \mbox{\hyperlink{class_d_b_s_c_a_n_aad8e927fe18f379b2c0cf65e9008ab42}{DBSCAN::get\_clusters}}()\{}
\DoxyCodeLine{00170\ \ \ std::map<\ std::pair<double,\ double>,\ int64\_t>\ ans;}
\DoxyCodeLine{00171\ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t}\ i\ =\ 0;\ i<setOfPoints.size();\ i++)\{}
\DoxyCodeLine{00172\ \ \ \ \ \textcolor{keywordflow}{if}(points[setOfPoints[i]]\ !=\ -\/1)\{}
\DoxyCodeLine{00173\ \ \ \ \ \ \ ans[setOfPoints[i]]\ =\ points[setOfPoints[i]];}
\DoxyCodeLine{00174\ \ \ \ \ \}}
\DoxyCodeLine{00175\ \ \ \}}
\DoxyCodeLine{00176\ \ \ \textcolor{keywordflow}{return}\ ans;}
\DoxyCodeLine{00177\ \}}
\DoxyCodeLine{00178\ }
\DoxyCodeLine{00179\ std::vector<\ std::pair<double,\ double>>\ \mbox{\hyperlink{class_d_b_s_c_a_n_ac9cfb1bc65f74713a0e3e0ec5a42a0a4}{DBSCAN::get\_noise}}()\{}
\DoxyCodeLine{00180\ \ \ std::vector<\ std::pair<double,\ double>\ >\ ans;}
\DoxyCodeLine{00181\ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t}\ i\ =\ 0;\ i<setOfPoints.size();\ i++)\{}
\DoxyCodeLine{00182\ \ \ \ \ \textcolor{keywordflow}{if}(points[setOfPoints[i]]\ ==\ -\/1)\{}
\DoxyCodeLine{00183\ \ \ \ \ \ \ ans.push\_back(setOfPoints[i]);}
\DoxyCodeLine{00184\ \ \ \ \ \}}
\DoxyCodeLine{00185\ \ \ \}}
\DoxyCodeLine{00186\ \ \ \textcolor{keywordflow}{return}\ ans;}
\DoxyCodeLine{00187\ \}}
\DoxyCodeLine{00188\ }
\DoxyCodeLine{00189\ }
\DoxyCodeLine{00190\ \textcolor{preprocessor}{\#endif}}

\end{DoxyCode}
