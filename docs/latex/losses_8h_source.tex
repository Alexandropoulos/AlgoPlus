\doxysection{losses.\+h}
\hypertarget{losses_8h_source}{}\label{losses_8h_source}\index{/Users/spirosmag/Documents/AlgoPlus/src/machine\_learning/loss\_functions/losses.h@{/Users/spirosmag/Documents/AlgoPlus/src/machine\_learning/loss\_functions/losses.h}}

\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{preprocessor}{\#ifndef\ MEAN\_SQUARED\_ERROR\_H}}
\DoxyCodeLine{00002\ \textcolor{preprocessor}{\#define\ MEAN\_SQUARED\_ERROR\_H}}
\DoxyCodeLine{00003\ }
\DoxyCodeLine{00004\ \textcolor{preprocessor}{\#ifdef\ \_\_cplusplus}}
\DoxyCodeLine{00005\ \textcolor{preprocessor}{\#include\ <iostream>}}
\DoxyCodeLine{00006\ \textcolor{preprocessor}{\#include\ <algorithm>}}
\DoxyCodeLine{00007\ \textcolor{preprocessor}{\#include\ <vector>}}
\DoxyCodeLine{00008\ \textcolor{preprocessor}{\#include\ <cmath>}}
\DoxyCodeLine{00009\ \textcolor{preprocessor}{\#include\ <cassert>}}
\DoxyCodeLine{00010\ \textcolor{preprocessor}{\#include\ <numbers>}}
\DoxyCodeLine{00011\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00012\ }
\DoxyCodeLine{00017\ \textcolor{keyword}{namespace\ }\mbox{\hyperlink{namespacelosses}{losses}}\ \{}
\DoxyCodeLine{00018\ \ \ \ \ }
\DoxyCodeLine{00024\ \ \ \textcolor{keywordtype}{double}\ \mbox{\hyperlink{namespacelosses_a809939c0f3e6f11e171bb9b310a11e94}{sigmoid}}(\textcolor{keywordtype}{double}\ x)\ \{}
\DoxyCodeLine{00025\ \ \ \ \ \textcolor{keywordflow}{return}\ 1.0\ /\ (1.0\ +\ exp(-\/x));}
\DoxyCodeLine{00026\ \ \ \}}
\DoxyCodeLine{00027\ }
\DoxyCodeLine{00034\ \ \ \textcolor{keywordtype}{double}\ \mbox{\hyperlink{namespacelosses_ad85f15dd23a95d7fb8c121ed1f1f8c73}{mean\_squared\_error}}(std::vector<double>\ \textcolor{keyword}{const}\&\ y,\ std::vector<double>\ \textcolor{keyword}{const}\&\ y\_hat)\ \{}
\DoxyCodeLine{00035\ \ \ \ \ assert(y.size()\ ==\ y\_hat.size());}
\DoxyCodeLine{00036\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ n\ =\ y.size();}
\DoxyCodeLine{00037\ \ \ \ \ \textcolor{keywordtype}{double}\ mse\ =\ 0.0;}
\DoxyCodeLine{00038\ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t}\ i\ =\ 0;\ i<n;\ i++)\ \{}
\DoxyCodeLine{00039\ \ \ \ \ \ \ \ \ mse\ +=\ powf(y[i]\ -\/\ y\_hat[i],\ 2);}
\DoxyCodeLine{00040\ \ \ \ \ \}}
\DoxyCodeLine{00041\ \ \ \ \ \textcolor{keywordflow}{return}\ mse\ /\ double(n);}
\DoxyCodeLine{00042\ \ \ \}}
\DoxyCodeLine{00043\ }
\DoxyCodeLine{00050\ \ \ \textcolor{keywordtype}{double}\ \mbox{\hyperlink{namespacelosses_a98a126498ecc2bb875e145027efcb81b}{root\_mean\_squared\_error}}(std::vector<double>\ \textcolor{keyword}{const}\&\ y,\ std::vector<double>\ \textcolor{keyword}{const}\&\ y\_hat)\ \{}
\DoxyCodeLine{00051\ \ \ \ \ \textcolor{keywordflow}{return}\ std::sqrt(\mbox{\hyperlink{namespacelosses_ad85f15dd23a95d7fb8c121ed1f1f8c73}{mean\_squared\_error}}(y,\ y\_hat));}
\DoxyCodeLine{00052\ \ \ \}}
\DoxyCodeLine{00053\ }
\DoxyCodeLine{00060\ \ \ \textcolor{keywordtype}{double}\ \mbox{\hyperlink{namespacelosses_a45d69f8aa2a85d3aa643fe6ec0578632}{mean\_absolute\_error}}(std::vector<double>\ \textcolor{keyword}{const}\&\ y,\ std::vector<double>\ \textcolor{keyword}{const}\&\ y\_hat)\ \{}
\DoxyCodeLine{00061\ \ \ \ \ assert(y.size()\ ==\ y\_hat.size());}
\DoxyCodeLine{00062\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ n\ =\ y.size();}
\DoxyCodeLine{00063\ \ \ \ \ \textcolor{keywordtype}{double}\ mae\ =\ 0.0;}
\DoxyCodeLine{00064\ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t}\ i\ =\ 0;\ i<n;\ i++)\ \{}
\DoxyCodeLine{00065\ \ \ \ \ \ \ \ \ mae\ +=\ std::abs(y[i]\ -\/\ y\_hat[i]);}
\DoxyCodeLine{00066\ \ \ \ \ \}}
\DoxyCodeLine{00067\ \ \ \ \ \textcolor{keywordflow}{return}\ mae\ /\ double(n);}
\DoxyCodeLine{00068\ \ \ \}}
\DoxyCodeLine{00069\ }
\DoxyCodeLine{00076\ \ \ \textcolor{keywordtype}{double}\ \mbox{\hyperlink{namespacelosses_a8362ab05aa78f30cffcb80efbad70aa2}{binary\_crossentropy\_loss}}(std::vector<double>\ \textcolor{keyword}{const}\&\ y,\ std::vector<double>\ \textcolor{keyword}{const}\&\ y\_hat)\ \{}
\DoxyCodeLine{00077\ \ \ \ \ assert(y.size()\ ==\ y\_hat.size());}
\DoxyCodeLine{00078\ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keyword}{auto}\ \&\ x\ :\ y)\ \{}
\DoxyCodeLine{00079\ \ \ \ \ \ \ \ \ assert(x\ ==\ 0.0\ ||\ x\ ==\ 1.0);}
\DoxyCodeLine{00080\ \ \ \ \ \}}
\DoxyCodeLine{00081\ }
\DoxyCodeLine{00082\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ n\ =\ y.size();}
\DoxyCodeLine{00083\ \ \ \ \ \textcolor{keywordtype}{double}\ bce\ =\ 0.0,\ eps\ =\ 1e-\/15;}
\DoxyCodeLine{00084\ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t}\ i\ =\ 0;\ i<n;\ i++)\ \{}
\DoxyCodeLine{00085\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ prob\ =\ \mbox{\hyperlink{namespacelosses_a809939c0f3e6f11e171bb9b310a11e94}{sigmoid}}(y\_hat[i]);}
\DoxyCodeLine{00086\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ clipped\_y\_hat\ =\ std::clamp(prob,\ eps,\ 1\ -\/\ eps);}
\DoxyCodeLine{00087\ \ \ \ \ \ \ \ \ bce\ +=\ (y[i]*log(clipped\_y\_hat)\ +\ (1-\/y[i])*log(1\ -\/\ clipped\_y\_hat));}
\DoxyCodeLine{00088\ \ \ \ \ \}}
\DoxyCodeLine{00089\ \ \ \ \ \textcolor{keywordflow}{return}\ -\/bce\ /\ double(n);}
\DoxyCodeLine{00090\ \ \ \}}
\DoxyCodeLine{00091\ \ \ }
\DoxyCodeLine{00092\ \}}
\DoxyCodeLine{00093\ }
\DoxyCodeLine{00094\ }
\DoxyCodeLine{00095\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00096\ }

\end{DoxyCode}
